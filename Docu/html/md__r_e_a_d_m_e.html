<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ShellYield: README</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ShellYield
   &#160;<span id="projectnumber">4.0.0</span>
   </div>
   <div id="projectbrief">read and consolidate Shelly Plug consumption.csv</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md__r_e_a_d_m_e.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">README </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Table of Contents</p>
<div id="top"></div><p> <br  />
 </p><div align="center"> <h3 align="center">ShellYield</h3>
</div><div align="center"> read and consolidate Shelly Plug consumption.csv <br  />
 <br  />
 <a href="https://github.com/Zheng-Bote/solaryield/issues">Report Bug</a> <a href="https://github.com/Zheng-Bote/solaryield/issues">Request Feature</a> <br  />
 </div><p><br  />
</p>
<p>&lt;details&gt;</p>
<ol>
<li>
<a href="#brief">Brief</a> </li>
<li>
<a href="#description">Description</a> </li>
<li>
<a href="#author">Author</a> </li>
<li>
<a href="#source">Source</a> </li>
<li>
<a href="#dependencies">Dependencies</a> </li>
<li>
<a href="#syntax">Syntax</a> </li>
<li>
<a href="#examples">Examples</a> </li>
<li>
<a href="#returns">Returns</a> </li>
<li>
<a href="#setup">Setup</a> </li>
<li>
<a href="#scenario">example scenario</a> </li>
<li>
<a href="#history">History</a> </li>
<li>
<a href="#contributing">Contributing</a> </li>
<li>
<a href="#contact">Contact</a> </li>
</ol>
<p>&lt;/details&gt; <br  />
</p>
<h4><a class="anchor" id="autotoc_md0"></a>
BRIEF:</h4>
<p><span id="brief"></span> read and consolidate Shelly Plug consumption.csv</p>
<h3><a class="anchor" id="autotoc_md1"></a>
VERSION:</h3>
<p><span id="version"></span> 4.0.0</p>
<h3><a class="anchor" id="autotoc_md2"></a>
Status</h3>
<p><img src="https://img.shields.io/badge/Status-usable-green" alt="ops" class="inline"/></p>
<h3><a class="anchor" id="autotoc_md3"></a>
DESC:</h3>
<p><span id="description"></span> C++20 program to read, clean and consolidate Shelly Plug consumption.csv.</p>
<p>Output to terminal, CSV or JSON file.</p>
<p>Several entries for the same day will be accumulated.</p>
<h3><a class="anchor" id="autotoc_md4"></a>
AUTHOR:</h3>
<p><span id="author"></span> ZHENG Robert</p>
<h3><a class="anchor" id="autotoc_md5"></a>
SOURCE:</h3>
<p><span id="source"></span> <a href="https://github.com/Zheng-Bote/solaryield">https://github.com/Zheng-Bote/solaryield</a></p>
<h3><a class="anchor" id="autotoc_md6"></a>
DEPENDENCIES:</h3>
<p><span id="dependencies"></span></p>
<h4><a class="anchor" id="autotoc_md7"></a>
cxxopts</h4>
<p>a lightweight C++ option parser library, supporting the standard GNU style syntax for options.</p>
<p>Source: <a href="https://github.com/jarro2783/cxxopts">https://github.com/jarro2783/cxxopts</a></p>
<p>License: MIT</p>
<h4><a class="anchor" id="autotoc_md8"></a>
plog</h4>
<p>Plog - portable, simple and extensible C++ logging library</p>
<p>Source: <a href="https://github.com/SergiusTheBest/plog">https://github.com/SergiusTheBest/plog</a></p>
<p>License: MIT</p>
<h4><a class="anchor" id="autotoc_md9"></a>
nlohmann/json</h4>
<p>JSON for Modern C++</p>
<p>Source: <a href="https://github.com/nlohmann/json">https://github.com/nlohmann/json</a></p>
<p>License: MIT</p>
<h3><a class="anchor" id="autotoc_md10"></a>
SYNTAX:</h3>
<p><span id="syntax"></span> Usage:</p>
<div class="fragment"><div class="line">./shellyield -h</div>
<div class="line">./shellyield --help</div>
</div><!-- fragment --><div class="fragment"><div class="line">shellyield -h</div>
<div class="line">collect Shelly yields</div>
<div class="line">Usage:</div>
<div class="line">  output/shellyield [OPTION...]</div>
<div class="line"> </div>
<div class="line">  -c, --csv arg        &lt;pathTo/inputfile.csv&gt;</div>
<div class="line">  -l, --list           list values</div>
<div class="line">      --writecsv arg   output to clean csv. If &quot;&quot;: &lt;yyyy-mm&gt;_&lt;1st_part_of_csvInputFile&gt;.csv (default: &quot;&quot;)</div>
<div class="line">      --csvout arg     &lt;path to csv output folder&gt;. If &quot;&quot;: ./csv_out/ (default: &quot;&quot;)</div>
<div class="line">      --writejson arg  output to JSON. If &quot;&quot;: &lt;yyyy-mm&gt;_&lt;1st_part_of_csvInputFile&gt;.json (default: &quot;&quot;)</div>
<div class="line">      --jsonout arg    &lt;path to JSON output folder&gt;. If &quot;&quot;: ./json_out/ (default: &quot;&quot;)</div>
<div class="line">      --logpath arg    &lt;pathToLogfile&gt;. if &quot;&quot;: ./log (default: &quot;&quot;)</div>
<div class="line">  -h, --help           Print usage</div>
<div class="line">  -v, --version        Version</div>
<div class="line">      --fullversion    Full Version</div>
<div class="line">      --program        Program</div>
</div><!-- fragment --><p>(<a href="#top">back to top</a>)</p>
<h4><a class="anchor" id="autotoc_md11"></a>
EXAMPLES:</h4>
<p><span id="examples"></span></p>
<ul>
<li>cleanup to csv</li>
</ul>
<div class="fragment"><div class="line">./shellyield --csv GH_Solar_0108202331082023_consumption.csv --writecsv ./new.csv</div>
</div><!-- fragment --><ul>
<li>cleanup to json</li>
</ul>
<div class="fragment"><div class="line">./shellyield --csv GH_Solar_0108202331082023_consumption.csv --writejson ./new.json</div>
</div><!-- fragment --><ul>
<li>add several csv (eg. several Shelly Plugs from same month) to clean csv and cumulated json</li>
</ul>
<div class="fragment"><div class="line">./shellyield --csv GH_Solar-1_0108202331082023_consumption.csv --writecsv ./GH_Solar_2023.csv</div>
<div class="line"> </div>
<div class="line">./shellyield --csv GH_Solar-2_0108202331082023_consumption.csv --writecsv ./GH_Solar_2023.csv</div>
<div class="line"> </div>
<div class="line">./shellyield --csv ./GH_Solar_2023.csv --writejson ./GH_Solar_2023.json</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md12"></a>
RETURNS:</h3>
<p><span id="returns"></span></p>
<div class="fragment"><div class="line">0 =&gt; OK</div>
<div class="line">1 =&gt; NOK</div>
</div><!-- fragment --><p>(<a href="#top">back to top</a>)</p>
<h3><a class="anchor" id="autotoc_md13"></a>
SETUP:</h3>
<p><span id="setup"></span></p>
<h4><a class="anchor" id="autotoc_md14"></a>
Debug:</h4>
<div class="fragment"><div class="line">g++-12 -std=c++20 -g3 -O0 -m64 -Wall -Wextra -Wpedantic -Wshadow -Wconversion -c -MMD src/main.cpp  -o src/main.o</div>
<div class="line">g++-12 -std=c++20 -g3 -O0 -m64 -Wall -Wextra -Wpedantic -Wshadow -Wconversion  -o output/shellyield src/main.o src/include/rz_shellyield.o</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md15"></a>
Release:</h4>
<div class="fragment"><div class="line">g++-12 -std=c++20 -O3 -m64 -Wall -Wextra -Wpedantic -Wshadow -Wconversion -c -MMD src/main.cpp  -o src/main.o</div>
<div class="line">g++-12 -std=c++20 -O3 -m64 -Wall -Wextra -Wpedantic -Wshadow -Wconversion -c -MMD src/include/rz_shellyield.cpp  -o src/include/rz_shellyield.o</div>
<div class="line">g++-12 -std=c++20 -O3 -m64 -Wall -Wextra -Wpedantic -Wshadow -Wconversion  -o output/shellyield src/main.o src/include/rz_shellyield.o</div>
</div><!-- fragment --><p>**_see also_**</p>
<p>Makefile</p>
<div class="fragment"><div class="line">./make</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md16"></a>
Binary:</h4>
<p>compiled on:</p>
<div class="fragment"><div class="line">Linux beelink 5.15.0-87-generic #97-Ubuntu SMP Mon Oct 2 21:09:21 UTC 2023 x86_64 x86_64 x86_64 GNU/Linux</div>
</div><!-- fragment --><p>Compiler/Linker:</p>
<div class="fragment"><div class="line">gcc version 12.3.0 (Ubuntu 12.3.0-1ubuntu1~22.04)</div>
</div><!-- fragment --><p>(<a href="#top">back to top</a>)</p>
<h4><a class="anchor" id="autotoc_md17"></a>
Example Scenario</h4>
<p><span id="scenario"></span></p>
<ul>
<li>in your Shelly app, choose a month and export the consumption as csv-file <img src="https://raw.githubusercontent.com/Zheng-Bote/solaryield/main/Examples/shelly_plug_monthly_export.jpg" alt="" max-width="180px" height="auto" class="inline"/></li>
<li>copy your csv-file to your linux machine</li>
<li>iwatch will automatically start the shellyield program:</li>
</ul>
<div class="fragment"><div class="line">&lt;?xml version=&quot;1.0&quot; ?&gt;</div>
<div class="line">&lt;!DOCTYPE config SYSTEM &quot;/etc/iwatch/iwatch.dtd&quot; &gt;</div>
<div class="line"> </div>
<div class="line">&lt;config charset=&quot;utf-8&quot;&gt;</div>
<div class="line">&lt;guard email=&quot;dummy@localhost&quot; name=&quot;iWatch&quot;/&gt;</div>
<div class="line">&lt;watchlist&gt;</div>
<div class="line">    &lt;title&gt;Solar&lt;/title&gt;</div>
<div class="line">    &lt;contactpoint email=&quot;dummy&quot; name=&quot;Administrator&quot;/&gt;</div>
<div class="line">    &lt;path type=&quot;single&quot; alert=&quot;off&quot; events=&quot;create,move&quot; exec=&quot;/usr/bin/sleep 2; /Mounts/Usb/Solar/shellyield --writecsv /Mounts/Usb/Solar/Output/shellies.csv --writelog /Mounts/Usb/Solar/Log/shellies.log --csv %f&quot;&gt;/Mounts/Usb/Solar/Input&lt;/path&gt;</div>
<div class="line">&lt;/watchlist&gt;</div>
<div class="line">&lt;/config&gt;</div>
</div><!-- fragment --><p><img src="https://raw.githubusercontent.com/Zheng-Bote/solaryield/main/Examples/iwatch.png" alt="" width="100%" height="auto" class="inline"/></p>
<ul>
<li>example output (csv):</li>
</ul>
<div class="fragment"><div class="line">2023-08-01,1363.290</div>
<div class="line">2023-08-02,2596.500</div>
<div class="line">2023-08-03,3572.160</div>
<div class="line">2023-08-04,1889.210</div>
<div class="line">2023-08-05,682.140</div>
<div class="line">2023-08-06,1757.170</div>
<div class="line">2023-08-07,2030.430</div>
<div class="line">2023-08-08,2830.230</div>
<div class="line">2023-08-09,845.770</div>
<div class="line">2023-08-10,3496.440</div>
<div class="line">2023-08-11,3649.010</div>
<div class="line">2023-08-12,2967.770</div>
<div class="line">2023-08-13,3179.720</div>
<div class="line">2023-08-14,3414.040</div>
<div class="line">2023-08-15,1521.920</div>
<div class="line">2023-08-16,1511.120</div>
<div class="line">2023-08-17,3413.260</div>
<div class="line">2023-08-18,3525.140</div>
<div class="line">2023-08-19,3394.840</div>
<div class="line">2023-08-20,3577.620</div>
<div class="line">2023-08-21,3511.590</div>
<div class="line">2023-08-22,2656.190</div>
<div class="line">2023-08-23,3377.280</div>
<div class="line">2023-08-24,3376.590</div>
<div class="line">2023-08-25,2267.050</div>
<div class="line">2023-08-26,2062.610</div>
<div class="line">2023-08-27,600.000</div>
<div class="line">2023-08-28,743.910</div>
<div class="line">2023-08-29,693.810</div>
<div class="line">2023-08-30,2048.360</div>
<div class="line">2023-08-31,2043.190</div>
</div><!-- fragment --><ul>
<li>example output (json):</li>
</ul>
<div class="fragment"><div class="line">[</div>
<div class="line">    {</div>
<div class="line">        &quot;months&quot;:</div>
<div class="line">            [</div>
<div class="line">                {</div>
<div class="line">                    &quot;days&quot;:</div>
<div class="line">                        [</div>
<div class="line">                            {&quot;day&quot;:&quot;01&quot;,&quot;val&quot;:1428.0},</div>
<div class="line">                            {&quot;day&quot;:&quot;02&quot;,&quot;val&quot;:328.30999755859375},</div>
<div class="line">                            {&quot;day&quot;:&quot;03&quot;,&quot;val&quot;:727.3200073242188},</div>
<div class="line">                            {&quot;day&quot;:&quot;04&quot;,&quot;val&quot;:967.3699951171875}</div>
<div class="line">                        ],</div>
<div class="line">                    &quot;month&quot;: &quot;01&quot;,</div>
<div class="line">                    &quot;month_name&quot;: &quot;January&quot;,</div>
<div class="line">                    &quot;name&quot;: &quot;garten&quot;,</div>
<div class="line">                    &quot;watt_per_month&quot;: 1865.679931640625</div>
<div class="line">                }</div>
<div class="line">            ],</div>
<div class="line">        &quot;year&quot;:&quot;2024&quot;</div>
<div class="line">    }</div>
<div class="line">]</div>
</div><!-- fragment --><ul>
<li>example logfile:</li>
</ul>
<div class="fragment"><div class="line">2023-11-01 11:58:10.713 INFO  [35911] [main@141] started: output/shellyield-0.3.0</div>
<div class="line">2023-11-01 11:58:10.631 INFO  [35911] [main@142] OK: Inputfile: Examples/GH_Solar_0108202331082023_consumption.csv</div>
<div class="line">2023-11-01 11:58:10.714 INFO  [35911] [main@159] OK: Outputfile: Examples/new.csv</div>
<div class="line">2023-11-01 11:58:10.086 INFO  [36007] [main@141] started: output/shellyield-0.3.0</div>
<div class="line">2023-11-01 11:58:10.086 INFO  [36007] [main@142] OK: Inputfile: Examples/GH_Solar_0108202331082023_consumption.csv</div>
<div class="line">2023-10-30 16:08:40.086 INFO  [36007] [main@175] OK: Outputfile: Examples/new.json</div>
</div><!-- fragment --><ul>
<li>example Graph:</li>
</ul>
<p>see <a href="https://github.com/Zheng-Bote/solargraph" alt="solargraph" title="https://github.com/Zheng-Bote/solargraph">Angular webapp to visualize ShellYield json</a></p>
<p><img src="https://raw.githubusercontent.com/Zheng-Bote/solaryield/main/Examples/graph.png" alt="" width="100%" height="auto" class="inline"/></p>
<p>(<a href="#top">back to top</a>)</p>
<h3><a class="anchor" id="autotoc_md18"></a>
HISTORY:</h3>
<p><span id="history"></span></p>
<blockquote class="doxtable">
<p>| Version | Date | Developer | Comments | | ----&mdash; | -------&mdash; | ------&mdash; | -------------------------------------------&mdash; | | 1.0.0 | 2023-10-28 | RZheng | created | | 1.0.1 | 2023-11-01 | RZheng | JSON modified | | 2.0.0 | 2024-04-20 | RZheng | JSON modified | | 3.0.0 | 2024-04-28 | RZheng | new input format due to Shelly firmware update | | 3.1.0 | 2024-05-04 | RZheng | JSON output enriched | | 4.0.0 | 2024-05-05 | RZheng | changed to object oriented due to enhancements | </p>
</blockquote>
<h2><a class="anchor" id="autotoc_md19"></a>
Contributing</h2>
<p><span id="contributing"></span></p>
<p>Contributions are what make the open source community such an amazing place to learn, inspire, and create. Any contributions you make are <b>greatly appreciated</b>.</p>
<p>If you have a suggestion that would make this better, please fork the repo and create a pull request. You can also simply open an issue with the tag "enhancement". Don't forget to give the project a star! Thanks again!</p>
<ol type="1">
<li>Fork the Project</li>
<li>Create your Feature Branch (<code>git checkout -b feature/AmazingFeature</code>)</li>
<li>Commit your Changes (&lsquo;git commit -m 'Add some AmazingFeature&rsquo;<code>)</code></li>
<li><code>Push to the Branch (</code>git push origin feature/AmazingFeature`)</li>
<li>Open a Pull Request</li>
</ol>
<p>(<a href="#top">back to top</a>)</p>
<h2><a class="anchor" id="autotoc_md20"></a>
Contact</h2>
<p><span id="contact"></span></p>
<p>ZHENG Robert Zhèng Bó Tè 郑 伯特</p>
<p>Project Link: <a href="https://github.com/Zheng-Bote/solaryield/">https://github.com/Zheng-Bote/solaryield/</a></p>
<p>:vulcan_salute:</p>
<p>(<a href="#top">back to top</a>)</p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
